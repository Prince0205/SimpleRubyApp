SimpleRubyApp:
  Type: Generic
  RuntimeVars:
    - PORT: "8080"
    - DATE: "`date -u`"
  ExecCommand: 'exec ./bundle/bin/thin start $ARGS'
  RunCommands:
    - 'echo "$DATE Starting App SimpleRubyApp"'
    - 'source "/usr/local/rvm/scripts/rvm"'
    - 'rvm use 1.9.2'
    - 'echo "Ruby Path `which ruby`"'
  Args:
    - '-p $PORT'
    - '-e production'
  PkgInclude:
    - 'lib/simplerubyapp/*.rb'
    - 'Gemfile'
    - 'config.ru'
    - 'SimpleRubyApp.gemspec'
  PostInstall:
    - 'echo "Starting PostInstall for SimpleRubyApp"'
    - 'source /usr/local/rvm/scripts/rvm'
    - 'rvm use 1.9.2'
    - 'echo "Ruby Path `which ruby`"'
    - 'bundle install --binstubs ./bundle/bin --standalone --path ./bundle/lib'
    - 'echo "Finished PostInstall for SimpleRubyApp"'